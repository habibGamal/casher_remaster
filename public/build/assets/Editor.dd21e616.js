import{M as g}from"./Meeting.018e0e1b.js";import{b as B,r as f,a as e,F as b,j as l,a2 as j,d as y}from"./app.0e9403f5.js";import{h as R,D as q}from"./index.8e24cd4e.js";import{I}from"./ImagesHandler.e7d6fa9d.js";import{F as r}from"./index.2c2f005b.js";import{I as c}from"./index.9f46615a.js";import{S as n}from"./index.b25a254c.js";import{U as H}from"./index.e82ad493.js";import{B as Y}from"./button.5253f3cb.js";import{P as z}from"./index.d62b0cca.js";import{m as _}from"./index.0df5407b.js";import{f as G}from"./faCaretRight.94301215.js";import{P as A}from"./PlusOutlined.cf2f5585.js";import{M as J}from"./MinusCircleOutlined.1e79c5ad.js";import"./type.6e629d5d.js";import"./index.ba3cb928.js";import"./index.ba991639.js";import"./KeyCode.bb3c3291.js";import"./index.92e459fd.js";import"./pickAttrs.90032313.js";import"./Overflow.a3e00ae0.js";import"./index.3b13b7dc.js";import"./CheckOutlined.545c81ed.js";import"./useForceUpdate.344e3908.js";import"./DeleteOutlined.5ec303bf.js";import"./progress.3d67026a.js";import"./ActionButton.83392556.js";function O({meeting:t=null}){var M,F,x,k,v,C,w,P,D,N;const[d]=r.useForm(),{errors:o}=B().props,[m,u]=f.exports.useState(t?I.getPathsAsUploadFiles(t.assets):[]),[L,S]=f.exports.useState([]);f.exports.useEffect(()=>{t&&(u(I.getPathsAsUploadFiles(t.assets)),S([]))},[t]);const T={beforeUpload:a=>!1,fileList:m,multiple:!0,onChange:({fileList:a})=>{u(a)},onRemove:a=>{S(i=>[...i,a.name])}},U=a=>{y.Inertia.post("/meetings",{...a,date:a!=null&&a.date?a.date.format("YYYY-MM-DD"):null,assets:m.map(i=>i.originFileObj)},{errorBag:"-1",preserveScroll:!0,forceFormData:!0,onSuccess:()=>{_.success("Meeting has been added succesfuly"),d.resetFields(),u([])}})},V=a=>{var p;const i={...a,assets:I.getNewUploadedFiles(m),date:(p=a==null?void 0:a.date)==null?void 0:p.format("YYYY-MM-DD"),removedAssets:L,_method:"put"};console.log(i),y.Inertia.post(`/meetings/${t.id}`,i,{forceFormData:!0,errorBag:`${t.id}`,preserveScroll:!0,onSuccess:()=>{_.success("Meeting updated succesfuly")}})},s=()=>t?o==null?void 0:o[`${t.id}`]:o==null?void 0:o["-1"];return e(b,{children:l("div",{className:"rounded bg-gray-100 shadow-sm p-4",children:[e(j,{icon:G.faCaretRight})," ",t?t.name:"Make a new meeting",l(r,{form:d,name:t?`edit_${t.id}`:"new",className:"max-w-[500px] mx-auto",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:t?V:U,autoComplete:"off",method:"post",encType:"multipart/form-data",children:[e(r.Item,{label:"Meeting Name",name:"name",initialValue:t==null?void 0:t.name,validateStatus:((M=s())==null?void 0:M.name)&&"error",help:(F=s())==null?void 0:F.name,children:e(c,{})}),e(r.Item,{label:"Meeting Link",name:"meeting_link",initialValue:t==null?void 0:t.link,validateStatus:((x=s())==null?void 0:x.meeting_link)&&"error",help:(k=s())==null?void 0:k.meeting_link,children:e(c,{})}),e(r.Item,{label:"Meeting Date",name:"date",initialValue:t?R(t.date):"",validateStatus:((v=s())==null?void 0:v.date)&&"error",help:(C=s())==null?void 0:C.date,children:e(q,{})}),e(r.Item,{label:"Meeting State",name:"state",initialValue:t==null?void 0:t.state,validateStatus:((w=s())==null?void 0:w.state)&&"error",help:(P=s())==null?void 0:P.state,children:l(n,{placeholder:"Select state",children:[e(n.Option,{value:"not_started",children:"Not Started"}),e(n.Option,{value:"in_meeting",children:"In Meeting"}),e(n.Option,{value:"ended",children:"Ended"}),e(n.Option,{value:"offline",children:"Offline"})]})}),e(r.Item,{label:"Assets",name:"assets[]",valuePropName:"fileList",children:e(b,{children:e(H,{...T,listType:"picture-card",children:l("div",{children:[e(A,{}),e("div",{style:{marginTop:8},children:"Upload"})]})})})}),e(r.Item,{name:"playlist_id",label:"Youtube playlist id",validateStatus:((D=s())==null?void 0:D.playlist_id)&&"error",help:(N=s())==null?void 0:N.playlist_id,children:e(c,{})}),e(r.List,{name:"videos",initialValue:t==null?void 0:t.videos,children:(a,{add:i,remove:p},{errors:$})=>l(b,{children:[a.map((h,E)=>l(r.Item,{label:`Video no ${E+1}`,required:!0,children:[e(r.Item,{...h,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input embed code here"}],noStyle:!0,children:e(c,{placeholder:"Embed code",style:{width:"80%"}})}),e(J,{className:"dynamic-delete-button mx-2",onClick:()=>p(h.name)})]},h.key)),l(r.Item,{wrapperCol:{offset:6,span:16},children:[e(Y,{type:"dashed",onClick:()=>i(),icon:e(A,{}),children:"Add video"}),e(r.ErrorList,{errors:$})]})]})}),e(r.Item,{wrapperCol:{offset:10,span:16},children:e(Y,{type:"primary",htmlType:"submit",children:"Save"})})]}),t&&e(z,{title:"Are you sure to delete this meeting?",onConfirm:()=>y.Inertia.delete(`/meetings/${t.id}`),okText:"Yes",cancelText:"No",children:e("span",{className:"ant-btn ant-btn-link ant-btn-dangerous",children:"Delete"})})]})})}function xe({meetingsDB:t}){const d=t.map(o=>new g(o));return l("div",{className:"container my-16 flex flex-col gap-4",children:[e(O,{}),d.map(o=>e(O,{meeting:o},o.id))]})}export{xe as default};
